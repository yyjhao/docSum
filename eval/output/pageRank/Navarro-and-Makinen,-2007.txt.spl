the search can finish in three possible ways : -LRB- i -RRB- at some point there is no edge leaving from the current node that matches the characters that follow in p , which means that p does not occur in t ; -LRB- ii -RRB- we read all the characters of p and end up at a tree node -LRB- or in the middle of an edge -RRB- , in which case all the answers are in the subtree of the reached node -LRB- or edge -RRB- ; or -LRB- iii -RRB- we reach a leaf of the suffix tree without having read the whole p , in which case there is at most one occurrence of p in t , which must be checked by going to the suffix pointed to by the leaf and comparing the rest of p with the rest
there are at most ^ log log n = -LRB- log n -RRB- log ^ different short patterns , each requiring a pointer of logn bits to its occurrence list , and the total number of primary occurrences for all short patterns is at most n ' -LRB- loglogn -RRB- 2 -LRB- as they must start at most log log n positions before a phrase border , and finish at most log log n positions after it -RRB- , each requiring log n bits as well .
